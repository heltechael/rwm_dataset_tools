2025-03-20 15:24:22,431 - __main__ - INFO - ================================================================================
2025-03-20 15:24:22,431 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-20 15:24:22,431 - __main__ - INFO - ================================================================================
2025-03-20 15:24:22,431 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-20 15:24:22,431 - __main__ - INFO - Log level: DEBUG
2025-03-20 15:24:22,431 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-20 15:24:22,431 - __main__ - INFO - Output format: yolov11
2025-03-20 15:24:22,431 - __main__ - INFO - Random seed: 42
2025-03-20 15:24:22,431 - __main__ - INFO - Loading configuration...
2025-03-20 15:24:22,431 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-20 15:24:22,432 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-20 15:24:22,440 - __main__ - INFO - Configuration loaded successfully
2025-03-20 15:24:22,441 - __main__ - INFO - Initializing database connection for debugging...
2025-03-20 15:24:22,441 - rwm_dataset_tools.database.connection - INFO - Connecting to database RoboWeedMaps on localhost...
2025-03-20 15:24:22,441 - rwm_dataset_tools.database.connection - DEBUG - Connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost;DATABASE=RoboWeedMaps;UID=SA;PWD=********;
2025-03-20 15:24:22,457 - rwm_dataset_tools.database.connection - INFO - Connected to database RoboWeedMaps on localhost
2025-03-20 15:24:22,457 - rwm_dataset_tools.database.connection - INFO - SQL Server version: Microsoft
2025-03-20 15:24:22,518 - rwm_dataset_tools.database.connection - INFO - Total images in database: 2499356
2025-03-20 15:24:22,557 - rwm_dataset_tools.database.connection - INFO - Total annotations in database: 2502824
2025-03-20 15:24:22,558 - __main__ - INFO - Running database structure checks...
2025-03-20 15:24:22,558 - rwm_dataset_tools.database.debug - INFO - Checking database structure...
2025-03-20 15:24:22,577 - rwm_dataset_tools.database.debug - INFO - Found 47 tables in the database
2025-03-20 15:24:22,578 - rwm_dataset_tools.database.debug - INFO - Key tables:
2025-03-20 15:24:22,578 - rwm_dataset_tools.database.debug - INFO -   data.AnnotationData (21 columns)
2025-03-20 15:24:22,579 - rwm_dataset_tools.database.debug - INFO -   data.Annotations (11 columns)
2025-03-20 15:24:22,579 - rwm_dataset_tools.database.debug - INFO -   data.Images (18 columns)
2025-03-20 15:24:22,579 - rwm_dataset_tools.database.debug - INFO -   data.PlantInfo (11 columns)
2025-03-20 15:24:22,579 - rwm_dataset_tools.database.debug - INFO -   data.Uploads (8 columns)
2025-03-20 15:24:22,582 - rwm_dataset_tools.database.debug - INFO - Table data.Images structure (18 columns):
2025-03-20 15:24:22,583 - rwm_dataset_tools.database.debug - INFO -   Id: int (Nullable: NO)
2025-03-20 15:24:22,584 - rwm_dataset_tools.database.debug - INFO -   UploadId: int (Nullable: NO)
2025-03-20 15:24:22,585 - rwm_dataset_tools.database.debug - INFO -   AnnotationId: int (Nullable: NO)
2025-03-20 15:24:22,586 - rwm_dataset_tools.database.debug - INFO -   IsDeleted: bit (Nullable: NO)
2025-03-20 15:24:22,587 - rwm_dataset_tools.database.debug - INFO -   FileName: nvarchar (Nullable: NO)
2025-03-20 15:24:22,590 - rwm_dataset_tools.database.debug - INFO - Table data.Annotations structure (11 columns):
2025-03-20 15:24:22,590 - rwm_dataset_tools.database.debug - INFO -   ImageId: int (Nullable: NO)
2025-03-20 15:24:22,592 - rwm_dataset_tools.database.debug - INFO -   UseForTraining: bit (Nullable: NO)
2025-03-20 15:24:22,596 - rwm_dataset_tools.database.debug - INFO - Table data.AnnotationData structure (21 columns):
2025-03-20 15:24:22,597 - rwm_dataset_tools.database.debug - INFO -   AnnotationId: int (Nullable: NO)
2025-03-20 15:24:22,597 - rwm_dataset_tools.database.debug - INFO -   PlantId: int (Nullable: NO)
2025-03-20 15:24:22,598 - rwm_dataset_tools.database.debug - INFO -   PolyData: nvarchar (Nullable: YES)
2025-03-20 15:24:22,598 - rwm_dataset_tools.database.debug - INFO -   MinX: int (Nullable: NO)
2025-03-20 15:24:22,599 - rwm_dataset_tools.database.debug - INFO -   MinY: int (Nullable: NO)
2025-03-20 15:24:22,599 - rwm_dataset_tools.database.debug - INFO -   MaxX: int (Nullable: NO)
2025-03-20 15:24:22,599 - rwm_dataset_tools.database.debug - INFO -   MaxY: int (Nullable: NO)
2025-03-20 15:24:22,601 - rwm_dataset_tools.database.debug - INFO - Table data.PlantInfo structure (11 columns):
2025-03-20 15:24:22,601 - rwm_dataset_tools.database.debug - INFO -   Id: int (Nullable: NO)
2025-03-20 15:24:22,602 - rwm_dataset_tools.database.debug - INFO -   EPPOCode: nchar (Nullable: YES)
2025-03-20 15:24:22,662 - rwm_dataset_tools.database.debug - INFO - Table data.Images contains 2499356 rows
2025-03-20 15:24:22,705 - rwm_dataset_tools.database.debug - INFO -   Active images (IsDeleted = 0): 2466063
2025-03-20 15:24:22,745 - rwm_dataset_tools.database.debug - INFO - Table data.Annotations contains 2502824 rows
2025-03-20 15:24:22,769 - rwm_dataset_tools.database.debug - INFO -   Training annotations (UseForTraining = 1): 70255
2025-03-20 15:24:23,263 - rwm_dataset_tools.database.debug - INFO - Table data.AnnotationData contains 114608631 rows
2025-03-20 15:24:23,265 - rwm_dataset_tools.database.debug - INFO - Table data.PlantInfo contains 340 rows
2025-03-20 15:24:23,304 - rwm_dataset_tools.database.debug - INFO - UseForTraining flag distribution:
2025-03-20 15:24:23,305 - rwm_dataset_tools.database.debug - INFO -   UseForTraining = False: 2432569 annotations
2025-03-20 15:24:23,305 - rwm_dataset_tools.database.debug - INFO -   UseForTraining = True: 70255 annotations
2025-03-20 15:24:23,306 - rwm_dataset_tools.database.debug - INFO - Found 0 annotations marked for training with missing bounding box coordinates
2025-03-20 15:24:23,811 - rwm_dataset_tools.database.debug - INFO - Found 127 annotations marked for training with NULL EPPO codes
2025-03-20 15:24:23,812 - rwm_dataset_tools.database.connection - INFO - Database connection closed
2025-03-20 15:24:23,812 - __main__ - INFO - Dry run completed. Exiting without creating dataset.
2025-03-20 15:29:38,602 - __main__ - INFO - ================================================================================
2025-03-20 15:29:38,602 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-20 15:29:38,602 - __main__ - INFO - ================================================================================
2025-03-20 15:29:38,602 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-20 15:29:38,602 - __main__ - INFO - Log level: INFO
2025-03-20 15:29:38,602 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-20 15:29:38,602 - __main__ - INFO - Output format: yolov11
2025-03-20 15:29:38,602 - __main__ - INFO - Output directory (override): /data/rwm_dataset_extraction/yolov11
2025-03-20 15:29:38,602 - __main__ - INFO - Random seed: 42
2025-03-20 15:29:38,602 - __main__ - INFO - Loading configuration...
2025-03-20 15:29:38,602 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-20 15:29:38,603 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-20 15:29:38,611 - __main__ - INFO - Configuration loaded successfully
2025-03-20 15:29:38,611 - __main__ - INFO - Creating yolov11 format handler...
2025-03-20 15:29:38,613 - __main__ - INFO - Format handler created. Output dir: /data/rwm_dataset_extraction/yolov11
2025-03-20 15:29:38,613 - __main__ - INFO - Creating dataset extractor...
2025-03-20 15:29:38,613 - __main__ - INFO - Dataset extractor created
2025-03-20 15:29:38,613 - __main__ - INFO - Starting dataset extraction process...
2025-03-20 15:29:38,613 - rwm_dataset_tools.dataset.extraction - INFO - Starting dataset extraction
2025-03-20 15:29:38,613 - rwm_dataset_tools.database.connection - INFO - Connecting to database RoboWeedMaps on localhost...
2025-03-20 15:29:38,634 - rwm_dataset_tools.database.connection - INFO - Connected to database RoboWeedMaps on localhost
2025-03-20 15:29:38,634 - rwm_dataset_tools.database.connection - INFO - SQL Server version: Microsoft
2025-03-20 15:29:38,686 - rwm_dataset_tools.database.connection - INFO - Total images in database: 2499356
2025-03-20 15:29:38,737 - rwm_dataset_tools.database.connection - INFO - Total annotations in database: 2502824
2025-03-20 15:29:38,738 - rwm_dataset_tools.dataset.extraction - INFO - Fetching annotation data from database...
2025-03-20 15:29:38,814 - rwm_dataset_tools.database.queries - INFO - Found 70204 images with UseForTraining=1 in the database
2025-03-20 15:29:38,814 - rwm_dataset_tools.database.queries - INFO - Fetching annotation data from database...
2025-03-20 15:29:38,814 - rwm_dataset_tools.database.queries - ERROR - Error executing annotation query: name 'time' is not defined
2025-03-20 15:29:38,814 - rwm_dataset_tools.database.queries - ERROR - Make sure the database schema matches what the query expects
2025-03-20 15:29:38,814 - rwm_dataset_tools.dataset.extraction - ERROR - Error during dataset extraction: name 'time' is not defined
2025-03-20 15:29:38,814 - rwm_dataset_tools.dataset.extraction - ERROR - Traceback (most recent call last):
  File "/data/rwm_dataset_tools/rwm_dataset_tools/dataset/extraction.py", line 54, in extract
    data = self.data_extractor.get_annotation_data()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/queries.py", line 106, in get_annotation_data
    start_time = time.time()
NameError: name 'time' is not defined

2025-03-20 15:29:38,815 - rwm_dataset_tools.database.connection - INFO - Database connection closed
2025-03-20 15:29:38,815 - __main__ - ERROR - Dataset extraction failed: name 'time' is not defined
2025-03-20 15:29:38,815 - __main__ - ERROR - Traceback (most recent call last):
  File "/data/rwm_dataset_tools/run.py", line 179, in main
    stats = extractor.extract()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/dataset/extraction.py", line 54, in extract
    data = self.data_extractor.get_annotation_data()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/queries.py", line 106, in get_annotation_data
    start_time = time.time()
NameError: name 'time' is not defined

2025-03-20 15:29:52,998 - __main__ - INFO - ================================================================================
2025-03-20 15:29:52,998 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-20 15:29:52,998 - __main__ - INFO - ================================================================================
2025-03-20 15:29:52,998 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-20 15:29:52,999 - __main__ - INFO - Log level: INFO
2025-03-20 15:29:52,999 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-20 15:29:52,999 - __main__ - INFO - Output format: yolov11
2025-03-20 15:29:52,999 - __main__ - INFO - Output directory (override): /data/rwm_dataset_extraction/yolov11
2025-03-20 15:29:52,999 - __main__ - INFO - Random seed: 42
2025-03-20 15:29:52,999 - __main__ - INFO - Loading configuration...
2025-03-20 15:29:52,999 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-20 15:29:53,000 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-20 15:29:53,008 - __main__ - INFO - Configuration loaded successfully
2025-03-20 15:29:53,008 - __main__ - INFO - Creating yolov11 format handler...
2025-03-20 15:29:53,009 - __main__ - INFO - Format handler created. Output dir: /data/rwm_dataset_extraction/yolov11
2025-03-20 15:29:53,009 - __main__ - INFO - Creating dataset extractor...
2025-03-20 15:29:53,009 - __main__ - INFO - Dataset extractor created
2025-03-20 15:29:53,009 - __main__ - INFO - Starting dataset extraction process...
2025-03-20 15:29:53,009 - rwm_dataset_tools.dataset.extraction - INFO - Starting dataset extraction
2025-03-20 15:29:53,009 - rwm_dataset_tools.database.connection - INFO - Connecting to database RoboWeedMaps on localhost...
2025-03-20 15:29:53,026 - rwm_dataset_tools.database.connection - INFO - Connected to database RoboWeedMaps on localhost
2025-03-20 15:29:53,026 - rwm_dataset_tools.database.connection - INFO - SQL Server version: Microsoft
2025-03-20 15:29:53,079 - rwm_dataset_tools.database.connection - INFO - Total images in database: 2499356
2025-03-20 15:29:53,119 - rwm_dataset_tools.database.connection - INFO - Total annotations in database: 2502824
2025-03-20 15:29:53,119 - rwm_dataset_tools.dataset.extraction - INFO - Fetching annotation data from database...
2025-03-20 15:29:53,167 - rwm_dataset_tools.database.queries - INFO - Found 70204 images with UseForTraining=1 in the database
2025-03-20 15:29:53,167 - rwm_dataset_tools.database.queries - INFO - Fetching annotation data from database...
2025-03-20 15:29:53,168 - rwm_dataset_tools.database.queries - ERROR - Error executing annotation query: name 'time' is not defined
2025-03-20 15:29:53,168 - rwm_dataset_tools.database.queries - ERROR - Make sure the database schema matches what the query expects
2025-03-20 15:29:53,168 - rwm_dataset_tools.dataset.extraction - ERROR - Error during dataset extraction: name 'time' is not defined
2025-03-20 15:29:53,168 - rwm_dataset_tools.dataset.extraction - ERROR - Traceback (most recent call last):
  File "/data/rwm_dataset_tools/rwm_dataset_tools/dataset/extraction.py", line 54, in extract
    data = self.data_extractor.get_annotation_data()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/queries.py", line 106, in get_annotation_data
    start_time = time.time()
NameError: name 'time' is not defined

2025-03-20 15:29:53,168 - rwm_dataset_tools.database.connection - INFO - Database connection closed
2025-03-20 15:29:53,169 - __main__ - ERROR - Dataset extraction failed: name 'time' is not defined
2025-03-20 15:29:53,169 - __main__ - ERROR - Traceback (most recent call last):
  File "/data/rwm_dataset_tools/run.py", line 179, in main
    stats = extractor.extract()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/dataset/extraction.py", line 54, in extract
    data = self.data_extractor.get_annotation_data()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/queries.py", line 106, in get_annotation_data
    start_time = time.time()
NameError: name 'time' is not defined

2025-03-20 15:30:14,346 - __main__ - INFO - ================================================================================
2025-03-20 15:30:14,346 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-20 15:30:14,346 - __main__ - INFO - ================================================================================
2025-03-20 15:30:14,346 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-20 15:30:14,346 - __main__ - INFO - Log level: INFO
2025-03-20 15:30:14,346 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-20 15:30:14,346 - __main__ - INFO - Output format: yolov11
2025-03-20 15:30:14,346 - __main__ - INFO - Output directory (override): /data/rwm_dataset_extraction/yolov11
2025-03-20 15:30:14,346 - __main__ - INFO - Random seed: 42
2025-03-20 15:30:14,346 - __main__ - INFO - Loading configuration...
2025-03-20 15:30:14,346 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-20 15:30:14,348 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-20 15:30:14,356 - __main__ - INFO - Configuration loaded successfully
2025-03-20 15:30:14,356 - __main__ - INFO - Creating yolov11 format handler...
2025-03-20 15:30:14,356 - __main__ - INFO - Format handler created. Output dir: /data/rwm_dataset_extraction/yolov11
2025-03-20 15:30:14,356 - __main__ - INFO - Creating dataset extractor...
2025-03-20 15:30:14,356 - __main__ - INFO - Dataset extractor created
2025-03-20 15:30:14,356 - __main__ - INFO - Starting dataset extraction process...
2025-03-20 15:30:14,356 - rwm_dataset_tools.dataset.extraction - INFO - Starting dataset extraction
2025-03-20 15:30:14,356 - rwm_dataset_tools.database.connection - INFO - Connecting to database RoboWeedMaps on localhost...
2025-03-20 15:30:14,376 - rwm_dataset_tools.database.connection - INFO - Connected to database RoboWeedMaps on localhost
2025-03-20 15:30:14,376 - rwm_dataset_tools.database.connection - INFO - SQL Server version: Microsoft
2025-03-20 15:30:14,422 - rwm_dataset_tools.database.connection - INFO - Total images in database: 2499356
2025-03-20 15:30:14,465 - rwm_dataset_tools.database.connection - INFO - Total annotations in database: 2502824
2025-03-20 15:30:14,465 - rwm_dataset_tools.dataset.extraction - INFO - Fetching annotation data from database...
2025-03-20 15:30:14,517 - rwm_dataset_tools.database.queries - INFO - Found 70204 images with UseForTraining=1 in the database
2025-03-20 15:30:14,517 - rwm_dataset_tools.database.queries - INFO - Fetching annotation data from database...
2025-03-20 15:30:23,184 - rwm_dataset_tools.database.connection - ERROR - Query execution failed: <class 'pyodbc.Error'> returned a result with an exception set
2025-03-20 15:30:23,184 - rwm_dataset_tools.database.connection - ERROR - Query: 
        SELECT
            [data].[AnnotationData].[Id],
            [UploadId],
            [FileName],
            [ImageId],
            [PlantId],
            TRIM([data].[PlantInfo].[EPPOCode]) AS EPPOCode,
            [NameEnglish],
            [GrowthStage],
            [Width],
            [Height],
            [PolyData],
            [BrushSize],
            [MinX],
            [MinY],
            [MaxX],
            [MaxY],
            [AnnotationModelId],
            [UseForTraining],
            [ClassificationModelId],
            [Approved],
            [GrownWeed],
            [cotyledon]
         FROM
            [data].[Images]
            INNER JOIN [data].[Annotations] ON ([data].[Annotations].[ImageId] = [data].[Images].[Id])
            LEFT JOIN [data].[AnnotationData] ON ([data].[AnnotationData].[AnnotationId] = [data].[Images].[Id])
            LEFT JOIN [data].[PlantInfo] ON ([AnnotationData].[PlantId] = [data].[PlantInfo].[Id])
            LEFT JOIN [data].[Uploads]  ON ([data].[Images].[UploadId] = [data].[Uploads].[Id])
         WHERE
            [data].[Images].[IsDeleted] = 0
            AND [data].[Uploads].[IsDeleted] = 0
            AND ([data].[AnnotationData].IsTemporary = 0 OR [data].[AnnotationData].IsTemporary is NULL)
            AND [data].[Annotations].[UseForTraining] = 1
            AND [data].[AnnotationData].[PlantId] NOT IN (-12, -7, 0, 148, 150, 151, 994)
        
2025-03-20 15:30:23,184 - rwm_dataset_tools.database.queries - ERROR - Error executing annotation query: <class 'pyodbc.Error'> returned a result with an exception set
2025-03-20 15:30:23,184 - rwm_dataset_tools.database.queries - ERROR - Make sure the database schema matches what the query expects
2025-03-20 15:30:23,184 - rwm_dataset_tools.dataset.extraction - ERROR - Error during dataset extraction: <class 'pyodbc.Error'> returned a result with an exception set
2025-03-20 15:30:23,185 - rwm_dataset_tools.dataset.extraction - ERROR - Traceback (most recent call last):
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/encodings/utf_16_le.py", line 15, in decode
    def decode(input, errors='strict'):
KeyboardInterrupt

The above exception was the direct cause of the following exception:

KeyboardInterrupt: decoding with 'utf-16le' codec failed (KeyboardInterrupt: )

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/rwm_dataset_tools/rwm_dataset_tools/dataset/extraction.py", line 54, in extract
    data = self.data_extractor.get_annotation_data()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/queries.py", line 108, in get_annotation_data
    data = self.db.execute_query(query)
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/connection.py", line 96, in execute_query
    return pd.read_sql(query, self.connection)
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/site-packages/pandas/io/sql.py", line 566, in read_sql
    return pandas_sql.read_query(
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/site-packages/pandas/io/sql.py", line 2094, in read_query
    data = self._fetchall_as_list(cursor)
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/site-packages/pandas/io/sql.py", line 2108, in _fetchall_as_list
    result = cur.fetchall()
SystemError: <class 'pyodbc.Error'> returned a result with an exception set

2025-03-20 15:30:23,186 - rwm_dataset_tools.database.connection - INFO - Database connection closed
2025-03-20 15:30:23,186 - __main__ - ERROR - Dataset extraction failed: <class 'pyodbc.Error'> returned a result with an exception set
2025-03-20 15:30:23,187 - __main__ - ERROR - Traceback (most recent call last):
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/encodings/utf_16_le.py", line 15, in decode
    def decode(input, errors='strict'):
KeyboardInterrupt

The above exception was the direct cause of the following exception:

KeyboardInterrupt: decoding with 'utf-16le' codec failed (KeyboardInterrupt: )

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/rwm_dataset_tools/run.py", line 179, in main
    stats = extractor.extract()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/dataset/extraction.py", line 54, in extract
    data = self.data_extractor.get_annotation_data()
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/queries.py", line 108, in get_annotation_data
    data = self.db.execute_query(query)
  File "/data/rwm_dataset_tools/rwm_dataset_tools/database/connection.py", line 96, in execute_query
    return pd.read_sql(query, self.connection)
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/site-packages/pandas/io/sql.py", line 566, in read_sql
    return pandas_sql.read_query(
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/site-packages/pandas/io/sql.py", line 2094, in read_query
    data = self._fetchall_as_list(cursor)
  File "/home/au-loke/miniconda/envs/roboweedmaps/lib/python3.10/site-packages/pandas/io/sql.py", line 2108, in _fetchall_as_list
    result = cur.fetchall()
SystemError: <class 'pyodbc.Error'> returned a result with an exception set

2025-03-20 15:34:08,228 - __main__ - INFO - ================================================================================
2025-03-20 15:34:08,228 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-20 15:34:08,228 - __main__ - INFO - ================================================================================
2025-03-20 15:34:08,228 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-20 15:34:08,228 - __main__ - INFO - Log level: INFO
2025-03-20 15:34:08,229 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-20 15:34:08,229 - __main__ - INFO - Output format: yolov11
2025-03-20 15:34:08,229 - __main__ - INFO - Output directory (override): /data/rwm_dataset_extraction/yolov11
2025-03-20 15:34:08,229 - __main__ - INFO - Random seed: 42
2025-03-20 15:34:08,229 - __main__ - INFO - Loading configuration...
2025-03-20 15:34:08,229 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-20 15:34:08,230 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-20 15:34:08,238 - __main__ - INFO - Configuration loaded successfully
2025-03-20 15:34:08,238 - __main__ - INFO - Creating yolov11 format handler...
2025-03-20 15:34:08,240 - __main__ - INFO - Format handler created. Output dir: /data/rwm_dataset_extraction/yolov11
2025-03-20 15:34:08,240 - __main__ - INFO - Creating dataset extractor...
2025-03-20 15:34:08,240 - __main__ - INFO - Dataset extractor created
2025-03-20 15:34:08,240 - __main__ - INFO - Starting dataset extraction process...
2025-03-20 15:34:08,240 - rwm_dataset_tools.dataset.extraction - INFO - Starting dataset extraction
2025-03-20 15:34:08,240 - rwm_dataset_tools.database.connection - INFO - Connecting to database RoboWeedMaps on localhost...
2025-03-20 15:34:08,254 - rwm_dataset_tools.database.connection - INFO - Connected to database RoboWeedMaps on localhost
2025-03-20 15:34:08,255 - rwm_dataset_tools.database.connection - INFO - SQL Server version: Microsoft
2025-03-20 15:34:08,312 - rwm_dataset_tools.database.connection - INFO - Total images in database: 2499356
2025-03-20 15:34:08,356 - rwm_dataset_tools.database.connection - INFO - Total annotations in database: 2502824
2025-03-20 15:34:08,356 - rwm_dataset_tools.dataset.extraction - INFO - Fetching annotation data from database...
2025-03-20 15:34:08,412 - rwm_dataset_tools.database.queries - INFO - Found 70204 images with UseForTraining=1 in the database
2025-03-20 15:34:08,412 - rwm_dataset_tools.database.queries - INFO - Fetching annotation data from database...
2025-03-20 15:35:01,938 - rwm_dataset_tools.database.queries - INFO - Fetched 2841468 annotation records in 53.53 seconds
2025-03-20 15:35:02,112 - rwm_dataset_tools.database.queries - INFO - Data includes 66397 unique images and 159 unique EPPO codes
2025-03-20 15:35:02,112 - rwm_dataset_tools.database.queries - INFO - Most common EPPO codes in the dataset:
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   PPPDD: 1587358 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   PPPMM: 414244 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   PSEZ: 72138 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   1CRUF: 43353 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   FAGES: 38108 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   CIRAR: 35401 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   BEAVA: 33357 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   SPQOL: 32428 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   BRSOL: 31159 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.database.queries - INFO -   VICFX: 30448 annotations
2025-03-20 15:35:02,300 - rwm_dataset_tools.dataset.extraction - INFO - Fetched 2841468 annotations in 53.94 seconds
2025-03-20 15:35:02,300 - rwm_dataset_tools.dataset.extraction - INFO - Sample annotation data:
2025-03-20 15:35:02,301 - rwm_dataset_tools.dataset.extraction - INFO -   Image: 992229, Upload: 1062, EPPO: BEAVA
2025-03-20 15:35:02,301 - rwm_dataset_tools.dataset.extraction - INFO -   Image: 992229, Upload: 1062, EPPO: BEAVA
2025-03-20 15:35:02,301 - rwm_dataset_tools.dataset.extraction - INFO -   Image: 991799, Upload: 1062, EPPO: BEAVA
2025-03-20 15:35:02,301 - rwm_dataset_tools.dataset.extraction - INFO - Filtering out held back images...
2025-03-20 15:35:02,657 - rwm_dataset_tools.database.queries - INFO - Filtered out held back images: 2841468 -> 2828766 annotations
2025-03-20 15:35:02,657 - rwm_dataset_tools.dataset.extraction - INFO - Processing PSEZ annotations...
2025-03-20 15:35:02,657 - rwm_dataset_tools.dataset.processing - INFO - Processing PSEZ annotations...
2025-03-20 15:35:03,675 - rwm_dataset_tools.dataset.processing - INFO - Found 71984 PSEZ annotations
2025-03-20 17:53:30,075 - rwm_dataset_tools.dataset.processing - INFO - Found 71371 valid PSEZ annotations inside crop boxes
2025-03-20 17:53:30,075 - rwm_dataset_tools.dataset.processing - INFO - Filtered out 613 PSEZ annotations
2025-03-20 17:53:31,133 - rwm_dataset_tools.dataset.extraction - INFO - Partitioning data by image ID...
2025-03-20 17:53:33,783 - rwm_dataset_tools.dataset.extraction - INFO - Dataset contains 66265 unique images
2025-03-20 17:53:33,783 - rwm_dataset_tools.dataset.extraction - INFO - Creating dataset files...
2025-03-20 17:53:33,783 - rwm_dataset_tools.dataset.extraction - INFO - Creating dataset files for 66265 images
2025-03-20 17:56:25,471 - rwm_dataset_tools.dataset.extraction - INFO - Creating dataset YAML file...
2025-03-20 17:56:25,472 - rwm_dataset_tools.dataset.formats.yolov11 - INFO - Created YOLOv11 dataset YAML with image size 1280
2025-03-20 17:56:25,472 - rwm_dataset_tools.dataset.extraction - INFO - Created dataset YAML file: /data/rwm_dataset_extraction/yolov11/dataset.yaml
2025-03-20 17:56:25,472 - rwm_dataset_tools.database.connection - INFO - Database connection closed
2025-03-20 17:56:26,661 - __main__ - INFO - Dataset extraction completed successfully
2025-03-20 17:56:26,661 - __main__ - INFO - ================================================================================
2025-03-20 17:56:26,661 - __main__ - INFO - DATASET EXTRACTION SUMMARY
2025-03-20 17:56:26,661 - __main__ - INFO - ================================================================================
2025-03-20 17:56:26,661 - __main__ - INFO - Total images processed: 66265
2025-03-20 17:56:26,661 - __main__ - INFO - Training set:   54600 images, 2336057 annotations
2025-03-20 17:56:26,661 - __main__ - INFO - Validation set: 11647 images, 491799 annotations
2025-03-20 17:56:26,661 - __main__ - INFO - Test set:       18 images, 297 annotations
2025-03-20 17:56:26,661 - __main__ - INFO - Total annotations: 2828153
2025-03-20 17:56:26,662 - __main__ - INFO - Average annotations per image: 42.68
2025-03-20 17:56:26,662 - __main__ - INFO - Split percentages: Train 82.4% / Val 17.6% / Test 0.0%
2025-03-20 17:56:26,662 - __main__ - INFO - Dataset created in: /data/rwm_dataset_extraction/yolov11
2025-03-20 17:56:26,662 - __main__ - INFO - Dataset YAML file: /data/rwm_dataset_extraction/yolov11/dataset.yaml
2025-03-20 17:56:26,662 - __main__ - INFO - ================================================================================
2025-03-20 17:56:26,662 - __main__ - INFO - For detailed logs, check rwm_extraction.log
2025-03-24 16:30:19,522 - __main__ - INFO - ================================================================================
2025-03-24 16:30:19,522 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-24 16:30:19,522 - __main__ - INFO - ================================================================================
2025-03-24 16:30:19,522 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-24 16:30:19,522 - __main__ - INFO - Log level: INFO
2025-03-24 16:30:19,522 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-24 16:30:19,522 - __main__ - INFO - Output format: yolov11
2025-03-24 16:30:19,522 - __main__ - INFO - Random seed: 42
2025-03-24 16:30:19,522 - __main__ - INFO - Loading configuration...
2025-03-24 16:30:19,522 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-24 16:30:19,523 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-24 16:30:19,533 - __main__ - INFO - Configuration loaded successfully
2025-03-24 16:30:19,533 - __main__ - INFO - Using default output directory: /fast_data/rwm_dataset_yolov11
2025-03-24 16:30:19,533 - __main__ - INFO - Images will be copied instead of symlinked
2025-03-24 16:30:19,533 - __main__ - INFO - Creating yolov11 format handler...
2025-03-24 16:30:19,533 - __main__ - ERROR - Failed to create format handler: [Errno 13] Permission denied: '/fast_data/rwm_dataset_yolov11'
2025-03-24 16:31:27,917 - __main__ - INFO - ================================================================================
2025-03-24 16:31:27,917 - __main__ - INFO - RWM Dataset Extraction Tool - Starting
2025-03-24 16:31:27,917 - __main__ - INFO - ================================================================================
2025-03-24 16:31:27,917 - __main__ - INFO - Python version: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
2025-03-24 16:31:27,917 - __main__ - INFO - Log level: INFO
2025-03-24 16:31:27,917 - __main__ - INFO - Config file: config/models/yolov11.yaml
2025-03-24 16:31:27,918 - __main__ - INFO - Output format: yolov11
2025-03-24 16:31:27,918 - __main__ - INFO - Random seed: 42
2025-03-24 16:31:27,918 - __main__ - INFO - Loading configuration...
2025-03-24 16:31:27,918 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/yolov11.yaml
2025-03-24 16:31:27,919 - rwm_dataset_tools.utils.config - INFO - Loading configuration from config/models/../default.yaml
2025-03-24 16:31:27,928 - __main__ - INFO - Configuration loaded successfully
2025-03-24 16:31:27,928 - __main__ - INFO - Using default output directory: /fast_data/rwm_dataset_yolov11
2025-03-24 16:31:27,928 - __main__ - INFO - Images will be copied instead of symlinked
2025-03-24 16:31:27,928 - __main__ - INFO - Creating yolov11 format handler...
2025-03-24 16:31:27,928 - __main__ - INFO - Format handler created. Output dir: /fast_data/rwm_dataset_yolov11
2025-03-24 16:31:27,929 - __main__ - INFO - Creating dataset extractor...
2025-03-24 16:31:27,929 - __main__ - INFO - Dataset extractor created
2025-03-24 16:31:27,929 - __main__ - INFO - Starting dataset extraction process...
2025-03-24 16:31:27,929 - rwm_dataset_tools.dataset.extraction - INFO - Starting dataset extraction
2025-03-24 16:31:27,929 - rwm_dataset_tools.database.connection - INFO - Connecting to database RoboWeedMaps on localhost...
2025-03-24 16:31:27,969 - rwm_dataset_tools.database.connection - INFO - Connected to database RoboWeedMaps on localhost
2025-03-24 16:31:27,969 - rwm_dataset_tools.database.connection - INFO - SQL Server version: Microsoft
2025-03-24 16:31:28,033 - rwm_dataset_tools.database.connection - INFO - Total images in database: 2512122
2025-03-24 16:31:28,093 - rwm_dataset_tools.database.connection - INFO - Total annotations in database: 2515590
2025-03-24 16:31:28,093 - rwm_dataset_tools.dataset.extraction - INFO - Fetching annotation data from database...
2025-03-24 16:31:28,298 - rwm_dataset_tools.database.queries - INFO - Found 70207 images with UseForTraining=1 in the database
2025-03-24 16:31:28,299 - rwm_dataset_tools.database.queries - INFO - Fetching annotation data from database...
2025-03-24 16:32:16,663 - rwm_dataset_tools.database.queries - INFO - Fetched 2841898 annotation records in 48.36 seconds
2025-03-24 16:32:16,844 - rwm_dataset_tools.database.queries - INFO - Data includes 66400 unique images and 159 unique EPPO codes
2025-03-24 16:32:16,844 - rwm_dataset_tools.database.queries - INFO - Most common EPPO codes in the dataset:
2025-03-24 16:32:17,002 - rwm_dataset_tools.database.queries - INFO -   PPPDD: 1587776 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   PPPMM: 414248 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   PSEZ: 72139 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   1CRUF: 43353 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   FAGES: 38108 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   CIRAR: 35401 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   BEAVA: 33357 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   SPQOL: 32428 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   BRSOL: 31166 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.database.queries - INFO -   VICFX: 30448 annotations
2025-03-24 16:32:17,003 - rwm_dataset_tools.dataset.extraction - INFO - Fetched 2841898 annotations in 48.91 seconds
2025-03-24 16:32:17,003 - rwm_dataset_tools.dataset.extraction - INFO - Sample annotation data:
2025-03-24 16:32:17,003 - rwm_dataset_tools.dataset.extraction - INFO -   Image: 726207, Upload: 861, EPPO: PPPDD
2025-03-24 16:32:17,003 - rwm_dataset_tools.dataset.extraction - INFO -   Image: 726207, Upload: 861, EPPO: PPPDD
2025-03-24 16:32:17,003 - rwm_dataset_tools.dataset.extraction - INFO -   Image: 744918, Upload: 869, EPPO: PPPDD
2025-03-24 16:32:17,003 - rwm_dataset_tools.dataset.extraction - INFO - Filtering out held back images...
2025-03-24 16:32:17,380 - rwm_dataset_tools.database.queries - INFO - Filtered out held back images: 2841898 -> 2829196 annotations
2025-03-24 16:32:17,380 - rwm_dataset_tools.dataset.extraction - INFO - Processing PSEZ annotations...
2025-03-24 16:32:17,380 - rwm_dataset_tools.dataset.processing - INFO - Processing PSEZ annotations...
2025-03-24 16:32:18,432 - rwm_dataset_tools.dataset.processing - INFO - Found 71985 PSEZ annotations
2025-03-24 18:23:19,202 - rwm_dataset_tools.dataset.processing - INFO - Found 71371 valid PSEZ annotations inside crop boxes
2025-03-24 18:23:19,202 - rwm_dataset_tools.dataset.processing - INFO - Filtered out 614 PSEZ annotations
2025-03-24 18:23:20,312 - rwm_dataset_tools.dataset.extraction - INFO - Partitioning data by image ID...
2025-03-24 18:23:23,071 - rwm_dataset_tools.dataset.extraction - INFO - Dataset contains 66268 unique images
2025-03-24 18:23:23,071 - rwm_dataset_tools.dataset.extraction - INFO - Creating dataset files...
2025-03-24 18:23:23,071 - rwm_dataset_tools.dataset.extraction - INFO - Creating dataset files for 66268 images
2025-03-24 19:07:28,292 - rwm_dataset_tools.dataset.extraction - WARNING - Image not found: /data/roboweedmaps/images/2026/20250324_091450_128452725a4473b7_17.jpeg (UploadId: 2026, ImageId: 2548824)
2025-03-24 19:07:28,310 - rwm_dataset_tools.dataset.extraction - WARNING - Image not found: /data/roboweedmaps/images/2026/20250324_091451_128452725a4473b7_18.jpeg (UploadId: 2026, ImageId: 2548825)
2025-03-24 19:07:28,311 - rwm_dataset_tools.dataset.extraction - WARNING - Image not found: /data/roboweedmaps/images/2026/20250324_091443_128452725a4473b7_13.jpeg (UploadId: 2026, ImageId: 2548830)
2025-03-24 19:07:28,312 - rwm_dataset_tools.dataset.extraction - WARNING - Skipped 3 images due to missing source files
2025-03-24 19:07:28,312 - rwm_dataset_tools.dataset.extraction - INFO - Creating dataset YAML file...
2025-03-24 19:07:28,315 - rwm_dataset_tools.dataset.formats.yolov11 - INFO - Created YOLOv11 dataset YAML with image size 1280
2025-03-24 19:07:28,315 - rwm_dataset_tools.dataset.extraction - INFO - Created dataset YAML file: /fast_data/rwm_dataset_yolov11/dataset.yaml
2025-03-24 19:07:28,316 - rwm_dataset_tools.database.connection - INFO - Database connection closed
2025-03-24 19:07:29,599 - __main__ - INFO - Dataset extraction completed successfully
2025-03-24 19:07:29,599 - __main__ - INFO - ================================================================================
2025-03-24 19:07:29,599 - __main__ - INFO - DATASET EXTRACTION SUMMARY
2025-03-24 19:07:29,599 - __main__ - INFO - ================================================================================
2025-03-24 19:07:29,599 - __main__ - INFO - Total images processed: 66268
2025-03-24 19:07:29,599 - __main__ - INFO - Training set:   54600 images, 2336057 annotations
2025-03-24 19:07:29,599 - __main__ - INFO - Validation set: 5839 images, 243250 annotations
2025-03-24 19:07:29,599 - __main__ - INFO - Test set:       5826 images, 248846 annotations
2025-03-24 19:07:29,599 - __main__ - INFO - Total annotations: 2828153
2025-03-24 19:07:29,599 - __main__ - WARNING - Skipped images: 3 (source files not found)
2025-03-24 19:07:29,599 - __main__ - INFO - Average annotations per image: 42.68
2025-03-24 19:07:29,600 - __main__ - INFO - Split percentages: Train 82.4% / Val 8.8% / Test 8.8%
2025-03-24 19:07:29,600 - __main__ - INFO - Dataset created in: /fast_data/rwm_dataset_yolov11
2025-03-24 19:07:29,600 - __main__ - INFO - Dataset YAML file: /fast_data/rwm_dataset_yolov11/dataset.yaml
2025-03-24 19:07:29,600 - __main__ - INFO - ================================================================================
2025-03-24 19:07:29,600 - __main__ - INFO - For detailed logs, check rwm_extraction.log
